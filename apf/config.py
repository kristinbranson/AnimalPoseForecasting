# TODO: Make these even more hierarchical (specify inputs per function)
config = {
 'load': {'datadir': '/groups/branson/home/eyjolfsdottire/data/mouse_experiment',
  'intrainfilestr': 'mouse_maze_train.npz',
  'invalfilestr': 'mouse_maze_val.npz',
  'categories': None,       # for filtering
  'augment_flip': False,
  },
 'feat': {
  'simplify_out': None,
  'simplify_in': None,
  'compute_pose_vel': True,
  'compute_sensory_diffs': True,             # what's this?
  'dct_tau': None,                           # what's this?
  'tspred_global': [1],
  'discrete_tspred': [1],
  'obs_embedding': False,
  'obs_embedding_types': None,               # what's this?
  'obs_embedding_params': None,
  'input_labels': False,
  'flatten_labels': False,
  'flatten_obs_idx': None,
  'flatten_do_separate_inputs': False,
  'discreteidx': None,
  'discretize_nbins': 25,
  'p_add_input_noise': 0,
  'input_noise_sigma': None,
  'all_discretize_epsilon': np.array([0.01322199, 0.01349601, 0.02598117, 0.02033068, 0.01859137,
         0.05900833, 0.05741996, 0.02196621, 0.0558432 , 0.02196207,
         0.05579313, 0.02626397, 0.12436298, 0.02276208, 0.04065661,
         0.02275847, 0.04038093, 0.02625952, 0.12736998, 0.02628111,
         0.13280959, 0.02628102, 0.13049692, 0.02439783, 0.0367505 ,
         0.02445746, 0.03742915, 0.02930942, 0.02496748]),
  'discretize_epsilon': None,
 },
 'train': {
  'device': 'cuda',
  'contextl': 64,
  'masktype': None,
  'max_mask_length': 4,
  'pmask': 0.15,
  'batch_size': 8,
  'num_train_epochs': 200,
  'epochs_rechunk': 5,
  'optimizer_args': {'lr': 0.0001, 'betas': [0.9, 0.999], 'eps': 1e-08},
  'max_grad_norm': 1.0,
  'numpy_seed': 123,
  'torch_seed': 456,
 },
 'model': {
  'modeltype': 'clm',
  'modelstatetype': None,
  'd_model': 2048,
  'nhead': 8,
  'd_hid': 512,
  'nlayers': 10,
  'dropout': 0.3,
  'pdropout_past': 0.0,
  'nstates': None,
  'minstateprob': None,
 },
 'save_model': {
  'savedir': '/groups/branson/home/eyjolfsdottire/data/mouse_experiment',
  'model_nickname': 'amazeing_mouse',
  'save_epoch': 2,
  'niterplot': 64,
 }
}
